@model List<TaskManagementMvc.Models.ProjectAccess>
@{
    ViewData["Title"] = "دسترسی‌های پروژه کاربر";
}

<div class="container">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="mb-0"><i class="bi bi-shield-check me-2"></i>دسترسی‌های پروژه</h2>
        <corp-btn asp-action="Index" asp-controller="Users" variant="outline" icon="bi-arrow-right" dense>بازگشت</corp-btn>
    </div>
    @if (Model != null && Model.Any())
    {
        <corp-table headers="نام پروژه,کد,شرکت,تاریخ اعطا,اعطا کننده,دلیل,وضعیت" hover dense>
            @foreach (var access in Model)
            {
                <tr class="@(access.IsActive ? "" : "opacity-75")">
                    <td><strong>@access.Project.Name</strong></td>
                    <td><corp-badge variant="info" dense>@access.Project.Code</corp-badge></td>
                    <td>@access.Project.Company?.Name</td>
                    <td class="text-muted small">@access.GrantedAt.ToPersianDateTime()</td>
                    <td class="text-muted small">@(access.GrantedBy?.FullName ?? "سیستم")</td>
                    <td class="text-muted small">@access.Reason</td>
                    <td>
                        @if (access.IsActive)
                        {
                            <corp-badge variant="success" icon="bi-check-circle" dense>فعال</corp-badge>
                        }
                        else
                        {
                            <corp-badge variant="secondary" icon="bi-x-circle" dense>غیرفعال</corp-badge>
                        }
                    </td>
                </tr>
            }
        </corp-table>
    }
    else
    {
        <div class="text-center py-5">
            <i class="bi bi-inbox display-1 text-muted"></i>
            <h4 class="text-muted mt-3">هیچ دسترسی پروژه‌ای یافت نشد</h4>
            <p class="text-muted">این کاربر هنوز به هیچ پروژه‌ای دسترسی ندارد.</p>
        </div>
    }
</div>
